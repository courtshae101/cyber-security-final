breaches <- read_csv("Cyber Security Breaches.xslx")
knitr::opts_chunk$set(echo = TRUE)
breaches <- read_csv("Cyber Security Breaches.xslx")
library(tidyverse)
breaches <- read_csv("Cyber Security Breaches.xslx")
breaches <- read_excel("Cyber Security Breaches.xslx")
breaches <- read_excel("Cyber Security Breaches.xlsx")
library(readxl)
breaches <- read_excel("Cyber Security Breaches.xlsx")
View(breaches)
breaches <- read_excel("Cyber Security Breaches.xlsx")
breaches <- read_csv("Cyber Security Breaches.csv")
library(tidyverse)
breaches <- read_csv("Cyber Security Breaches.csv")
number_of_breaches <- breaches %>%
group_by(year)%>%
summarise(freq = n())
View(number_of_breaches)
library(ggplot2)
ggplot(number_of_breaches, aes(year, freq)) +
ggbar()
barplot(number_of_breaches, xlab = year, ylab = freq)
ggplot(number_of_breaches, aes(year, freq)) +
gghist()
ggplot(number_of_breaches, aes(year, freq)) +
gghistogram()
library(ggplot2)
library(ggplot)
library(ggplot2)
ggplot(number_of_breaches, aes(year, freq)) +
geom_bar()
rlang::last_error()
ggplot(number_of_breaches, aes(year, freq)) +
geom_histogram()
ggplot(number_of_breaches, aes(year, freq)) +
geom_histogram(bin = 1)
number_of_breaches <- breaches %>%
group_by(year)%>%
summarise(freq = n())
ggplot(number_of_breaches, aes(year, freq)) +
geom_histogram(bin = 1)
ggplot(number_of_breaches, aes(year, freq)) +
geom_histogram(stat = "identity")
missing <- na.omit(breaches$year)
isna(breaches$year)
is.na(breaches$year)
missing <- is.na(breaches$year)
knitr::opts_chunk$set(echo = TRUE)
library(gapminder)
gapminder
gapminder %>%
ggplot(aes(year, lifeExp, group = country)) +
geom_line(alpha = 1/3)
library(tidyverse)
library(tidyverse)
library(modelr)
library(gapminder)
gapminder %>%
ggplot(aes(gdpPercap, lifeExp, group = country, color = continent)) +
geom_line(alpha = 1/3)
gp_mod <- lm(lifeExp ~ gdpPercap, data = gapminder)
gapminder %>%
add_predictions(gp_mod) %>%
ggplot(aes(gdpPercap, pred)) +
geom_line() +
ggtitle("Linear trend + ")
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
lm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country %>%
arrange(continent, country)
by_country <- by_country %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
stats::glm(lifeExp ~ gdpPercap, data = df)
}
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
lm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country %>%
arrange(continent, country)
by_country <- by_country %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
models <- map(by_country$data, country_model_glm)
stats::glm(lifeExp ~ gdpPercap, data = df)
library(stats)
country_model_glm <- function(df) {
stats::glm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model_glm)
by_country <- by_country %>%
mutate(model = map(data, country_model_glm))
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
lm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country %>%
arrange(continent, country)
by_country <- by_country %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
stats::glm(lifeExp ~ gdpPercap, data = df)
library(stats)
country_model_glm <- function(df) {
stats::glm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model_glm)
by_country_glm <- by_country %>%
mutate(model = map(data, country_model_glm))
by_country %>%
arrange(continent, country)
by_country_glm %>%
arrange(continent, country)
by_country_glm <- by_country_glm %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country_glm, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
lm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country %>%
arrange(continent, country)
by_country <- by_country %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
library(stats)
country_model_glm <- function(df) {
stats::glm(lifeExp ~ gdpPercap, data = df)
}
models_glm <- map(by_country$data, country_model_glm)
by_country_glm <- by_country %>%
mutate(model = map(data, country_model_glm))
by_country_glm %>%
arrange(continent, country)
by_country_glm <- by_country_glm %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country_glm, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
glm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country %>%
arrange(continent, country)
by_country <- by_country %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
rlm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
library(MASS)
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
rlm(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country %>%
arrange(continent, country)
by_country <- by_country %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
library(rpart)
by_country <- gapminder %>%
group_by(country, continent) %>%
nest()
country_model <- function(df) {
rpart(lifeExp ~ gdpPercap, data = df)
}
models <- map(by_country$data, country_model)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country %>%
arrange(continent, country)
by_country <- by_country %>%
mutate(
resids = map2(data, model, add_residuals)
)
resids <- unnest(by_country, resids)
resids %>%
ggplot(aes(gdpPercap, resid, group = country)) +
geom_line(alpha = 1 / 3) +
facet_wrap(~continent)
